# PCA9685 Go Library üîß

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–∞ Go –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è PWM-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–º PCA9685 —á–µ—Ä–µ–∑ I2C.**  
–ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è RGB-—Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞–º–∏, —Å–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥–∞–º–∏, –Ω–∞—Å–æ—Å–∞–º–∏, –º–æ—Ç–æ—Ä–∞–º–∏ –∏ –¥—Ä—É–≥–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –≤ IoT –∏ —Ä–æ–±–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–µ.

[![Go Version](https://img.shields.io/badge/Go-1.20%2B-blue)](https://golang.org)
[![License: MIT](https://img.shields.io/badge/License-MIT-green)](LICENSE)
[![Open Source](https://badges.frapsoft.com/os/v2/open-source.svg)](https://opensource.org)

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ ‚ú®
- üîí –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- üéõ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 16 –∫–∞–Ω–∞–ª–æ–≤ PWM —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º 12 –±–∏—Ç (0‚Äì4095)
- ‚úÖ –ì–æ—Ç–æ–≤—ã–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –¥–ª—è RGB-—Å–≤–µ—Ç–æ–¥–∏–æ–¥–æ–≤ –∏ –Ω–∞—Å–æ—Å–æ–≤ —Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π
- ‚ö° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–∞—Å—Ç–æ—Ç—ã PWM (24‚Äì1526 –ì—Ü)
- üîÑ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
- üìñ 100% –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
- üí™ –û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∏ –∑–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ üì¶
```bash
go get github.com/SNAcorp/pca9685
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç üöÄ
### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
```go
// –°–æ–∑–¥–∞–Ω–∏–µ I2C —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
i2c := NewI2CDevice() 

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
config := pca9685.DefaultConfig()
config.InitialFreq = 1000    // 1000 –ì—Ü
config.InvertLogic = false   // –ü—Ä—è–º–∞—è –ª–æ–≥–∏–∫–∞
config.Context = ctx         // –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –æ—Ç–º–µ–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–π

// –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
pca, err := pca9685.New(i2c, config)
if err != nil {
    log.Fatal(err)
}
defer pca.Close()
```

### 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ RGB-—Å–≤–µ—Ç–æ–¥–∏–æ–¥–æ–º
```go
// –°–æ–∑–¥–∞–Ω–∏–µ RGB —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞ –Ω–∞ –∫–∞–Ω–∞–ª–∞—Ö 0,1,2
led, err := pca9685.NewRGBLed(pca, 0, 1, 2)
if err != nil {
    log.Fatal(err)
}

// –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –¥–ª—è —Ç–æ—á–Ω–æ–π —Ü–≤–µ—Ç–æ–ø–µ—Ä–µ–¥–∞—á–∏
cal := pca9685.RGBCalibration{
    RedMin: 0, RedMax: 4095,
    GreenMin: 0, GreenMax: 3800,
    BlueMin: 100, BlueMax: 4095,
}
led.SetCalibration(cal)

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–≤–µ—Ç–∞ –∏ —è—Ä–∫–æ—Å—Ç–∏
ctx := context.Background()
led.SetBrightness(0.7)                    // 70% —è—Ä–∫–æ—Å—Ç–∏
led.SetColor(ctx, 255, 0, 128)            // –†–æ–∑–æ–≤—ã–π —Ü–≤–µ—Ç
led.SetColorStdlib(ctx, color.RGBA{...})  // –ß–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–∞–∫–µ—Ç color
```

### 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å–æ—Å–æ–º
```go
// –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—Å–æ—Å–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏
pump, err := pca9685.NewPump(pca, 4, 
    pca9685.WithSpeedLimits(500, 3500))
if err != nil {
    log.Fatal(err)
}

ctx := context.Background()
// –ü–ª–∞–≤–Ω—ã–π –∑–∞–ø—É—Å–∫
pump.SetSpeed(ctx, 85)           // 85% –º–æ—â–Ω–æ—Å—Ç–∏
speed, _ := pump.GetCurrentSpeed() // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
pump.Stop(ctx)                   // –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```

### 4. –ì—Ä—É–ø–ø–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```go
// –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤
settings := map[int]struct{ On, Off uint16 }{
    0: {0, 2048},  // 50% –Ω–∞ –∫–∞–Ω–∞–ª–µ 0
    1: {0, 4095},  // 100% –Ω–∞ –∫–∞–Ω–∞–ª–µ 1
    2: {2048, 4095}, // –û—Å–æ–±—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–∞ –∫–∞–Ω–∞–ª–µ 2
}

ctx := context.Background()
pca.SetMultiPWM(ctx, settings)

// –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –≥—Ä—É–ø–ø –∫–∞–Ω–∞–ª–æ–≤
pca.EnableChannels(0, 1, 2)
pca.DisableChannels(3, 4)
```

## –ü—Ä–∏–º–µ—Ä—ã üß™
- [RGB-—Å–≤–µ—Ç–æ–¥–∏–æ–¥](examples/rgb_led) ‚Äî –∞–Ω–∏–º–∞—Ü–∏—è —Å –ø–ª–∞–≤–Ω—ã–º–∏ –ø–µ—Ä–µ—Ö–æ–¥–∞–º–∏
- [–ù–∞—Å–æ—Å](examples/pump) ‚Äî –ø–ª–∞–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ –∏ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏
- [–ì—Ä—É–ø–ø–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ](examples/multi) ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è üìö
### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç       | –û–ø–∏—Å–∞–Ω–∏–µ                                          |
|----------------|--------------------------------------------------|
| `PCA9685`      | –ë–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç–∏    |
| `RGBLed`       | RGB —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã —Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π –∏ —Ü–≤–µ—Ç–æ–∫–æ—Ä—Ä–µ–∫—Ü–∏–µ–π    |
| `Pump`         | –ù–∞—Å–æ—Å—ã —Å –ø–ª–∞–≤–Ω—ã–º –ø—É—Å–∫–æ–º –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —Å–∫–æ—Ä–æ—Å—Ç–∏    |
| `Config`       | –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤       |

[–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚Üí](docs/API.md)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å üõ°
- ‚úÖ –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ sync.Mutex
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ —á–µ—Ä–µ–∑ context.Context
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –≥–æ–Ω–æ–∫ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ I2C

## –ö–∞–∫ –≤–Ω–µ—Å—Ç–∏ –≤–∫–ª–∞–¥ ü§ù
1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É: `git checkout -b feature/your-idea`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã: `go test -race ./...`
4. –°–¥–µ–ª–∞–π—Ç–µ –∫–æ–º–º–∏—Ç: `git commit -m 'Add awesome feature'`
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å üîå
**–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞:**
- Raspberry Pi (–≤—Å–µ –º–æ–¥–µ–ª–∏)
- Orange Pi
- NVIDIA Jetson
- –õ—é–±—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π I2C

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏ üîó
- [–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è PCA9685](https://www.nxp.com/docs/en/data-sheet/PCA9685.pdf)
- [Go context package](https://golang.org/pkg/context/)
- [I2C –≤ Go](https://pkg.go.dev/golang.org/x/exp/io/i2c)

## –õ–∏—Ü–µ–Ω–∑–∏—è ‚öñÔ∏è
MIT License ¬© 2024 [SNAcorp]. –°–º. [LICENSE](LICENSE).

---

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å. –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.**